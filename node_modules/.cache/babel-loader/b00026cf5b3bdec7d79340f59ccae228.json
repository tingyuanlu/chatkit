{"ast":null,"code":"'use strict';\n\nvar _toConsumableArray = require(\"/Users/tingyuan.lu/chatkit/node_modules/@babel/runtime/helpers/toConsumableArray\");\n\nvar _slicedToArray = require(\"/Users/tingyuan.lu/chatkit/node_modules/@babel/runtime/helpers/slicedToArray\");\n\nvar _require = require('url'),\n    URL = _require.URL;\n\nvar is = require('@sindresorhus/is');\n\nvar knownHookEvents = require('./known-hook-events');\n\nvar merge = function merge(target) {\n  for (var _len = arguments.length, sources = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    sources[_key - 1] = arguments[_key];\n  }\n\n  for (var _i = 0, _sources = sources; _i < _sources.length; _i++) {\n    var source = _sources[_i];\n\n    for (var _i2 = 0, _Object$entries = Object.entries(source); _i2 < _Object$entries.length; _i2++) {\n      var _Object$entries$_i = _slicedToArray(_Object$entries[_i2], 2),\n          key = _Object$entries$_i[0],\n          sourceValue = _Object$entries$_i[1];\n\n      if (is.undefined(sourceValue)) {\n        continue;\n      }\n\n      var targetValue = target[key];\n\n      if (is.urlInstance(targetValue) && (is.urlInstance(sourceValue) || is.string(sourceValue))) {\n        target[key] = new URL(sourceValue, targetValue);\n      } else if (is.plainObject(sourceValue)) {\n        if (is.plainObject(targetValue)) {\n          target[key] = merge({}, targetValue, sourceValue);\n        } else {\n          target[key] = merge({}, sourceValue);\n        }\n      } else if (is.array(sourceValue)) {\n        target[key] = merge([], sourceValue);\n      } else {\n        target[key] = sourceValue;\n      }\n    }\n  }\n\n  return target;\n};\n\nvar mergeOptions = function mergeOptions() {\n  for (var _len2 = arguments.length, sources = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    sources[_key2] = arguments[_key2];\n  }\n\n  sources = sources.map(function (source) {\n    return source || {};\n  });\n  var merged = merge.apply(void 0, [{}].concat(_toConsumableArray(sources)));\n  var hooks = {};\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = knownHookEvents[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var hook = _step.value;\n      hooks[hook] = [];\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return != null) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  var _iteratorNormalCompletion2 = true;\n  var _didIteratorError2 = false;\n  var _iteratorError2 = undefined;\n\n  try {\n    for (var _iterator2 = sources[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n      var source = _step2.value;\n\n      if (source.hooks) {\n        var _iteratorNormalCompletion3 = true;\n        var _didIteratorError3 = false;\n        var _iteratorError3 = undefined;\n\n        try {\n          for (var _iterator3 = knownHookEvents[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n            var _hook = _step3.value;\n            hooks[_hook] = hooks[_hook].concat(source.hooks[_hook]);\n          }\n        } catch (err) {\n          _didIteratorError3 = true;\n          _iteratorError3 = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n              _iterator3.return();\n            }\n          } finally {\n            if (_didIteratorError3) {\n              throw _iteratorError3;\n            }\n          }\n        }\n      }\n    }\n  } catch (err) {\n    _didIteratorError2 = true;\n    _iteratorError2 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n        _iterator2.return();\n      }\n    } finally {\n      if (_didIteratorError2) {\n        throw _iteratorError2;\n      }\n    }\n  }\n\n  merged.hooks = hooks;\n  return merged;\n};\n\nvar mergeInstances = function mergeInstances(instances, methods) {\n  var handlers = instances.map(function (instance) {\n    return instance.defaults.handler;\n  });\n  var size = instances.length - 1;\n  return {\n    methods: methods,\n    options: mergeOptions.apply(void 0, _toConsumableArray(instances.map(function (instance) {\n      return instance.defaults.options;\n    }))),\n    handler: function handler(options, next) {\n      var iteration = -1;\n\n      var iterate = function iterate(options) {\n        return handlers[++iteration](options, iteration === size ? next : iterate);\n      };\n\n      return iterate(options);\n    }\n  };\n};\n\nmodule.exports = merge;\nmodule.exports.options = mergeOptions;\nmodule.exports.instances = mergeInstances;","map":null,"metadata":{},"sourceType":"script"}