{"ast":null,"code":"'use strict';\n\nvar decompressResponse = require('decompress-response');\n\nvar is = require('@sindresorhus/is');\n\nvar mimicResponse = require('mimic-response');\n\nvar progress = require('./progress');\n\nmodule.exports = function (response, options, emitter) {\n  var downloadBodySize = Number(response.headers['content-length']) || null;\n  var progressStream = progress.download(response, emitter, downloadBodySize);\n  mimicResponse(response, progressStream);\n  var newResponse = options.decompress === true && is.function(decompressResponse) && options.method !== 'HEAD' ? decompressResponse(progressStream) : progressStream;\n\n  if (!options.decompress && ['gzip', 'deflate'].includes(response.headers['content-encoding'])) {\n    options.encoding = null;\n  }\n\n  emitter.emit('response', newResponse);\n  emitter.emit('downloadProgress', {\n    percent: 0,\n    transferred: 0,\n    total: downloadBodySize\n  });\n  response.pipe(progressStream);\n};","map":null,"metadata":{},"sourceType":"script"}